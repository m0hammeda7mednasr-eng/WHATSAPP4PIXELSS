# ๐ง ุญู ุฌููุน ุงููุดุงูู - ุฏููู ููุงุฆู

## ุงููุดููุฉ 1: Shopify OAuth - "redirect_uri is not whitelisted"

### ุงูุณุจุจ:
Shopify ูุด ุนุงุฑู ุงููููู ุจุชุงุน OAuth

### ุงูุญู (5 ุฏูุงุฆู):

#### ุงูุฎุทูุฉ 1: ุงูุชุญ Shopify Admin
```
https://admin.shopify.com/store/YOUR-STORE/settings/apps/development
```

#### ุงูุฎุทูุฉ 2: ุงุฎุชุฑ ุงูุชุทุจูู
- ุงุถุบุท ุนูู ุงูุชุทุจูู ุงููู ุนููุชู
- ุฃู ุงุนูู ุชุทุจูู ุฌุฏูุฏ (Create an app)

#### ุงูุฎุทูุฉ 3: ุฃุถู Redirect URL
1. ุงุถุบุท ุนูู **Configuration**
2. ุงุจุญุซ ุนู **App URL** ุฃู **Allowed redirection URL(s)**
3. ุฃุถู ุงููููู ุฏู **ุจุงูุถุจุท**:
```
https://wahtsapp2.vercel.app/api/shopify/oauth/callback
```

#### ุงูุฎุทูุฉ 4: ุงุถุจุท ุงูุตูุงุญูุงุช
1. ุงุถุบุท **Configure Admin API scopes**
2. ุงุฎุชุงุฑ:
   - โ `read_orders`
   - โ `write_orders`
3. ุงุถุบุท **Save**

#### ุงูุฎุทูุฉ 5: Install ุงูุชุทุจูู
1. ุงุถุบุท **Install app** (ุฃุนูู ุงููููู)
2. ูุงูู ุนูู ุงูุตูุงุญูุงุช

#### ุงูุฎุทูุฉ 6: ุฌุฑุจ OAuth
- ุงุฑุฌุน ูููููุน
- Settings โ Shopify Integration
- ุงุฎุชุงุฑ **OAuth (Advanced)**
- ุงููุฃ ุงูุจูุงูุงุช ูุงุถุบุท Connect

---

## ุงููุดููุฉ 2: WhatsApp Webhook - "couldn't be validated"

### ุงูุณุจุจ:
Meta ูุด ูุงุฏุฑ ูุชุญูู ูู ุงูู Webhook

### ุงูุญู (3 ุฏูุงุฆู):

#### ุงูุฎุทูุฉ 1: ุชุฃูุฏ ูู Environment Variables ูู Vercel
1. ุงูุชุญ Vercel Dashboard
2. ุงุฎุชุงุฑ ุงููุดุฑูุน `wahtsapp2`
3. Settings โ Environment Variables
4. ุชุฃูุฏ ูู ูุฌูุฏ:
```
WEBHOOK_VERIFY_TOKEN = whatsapp_crm_2024
VITE_SUPABASE_URL = https://rmpgofswkpjxionzythf.supabase.co
VITE_SUPABASE_ANON_KEY = [your-anon-key]
```

#### ุงูุฎุทูุฉ 2: Redeploy
```bash
# ูู Vercel Dashboard
Deployments โ Latest โ Redeploy
```

#### ุงูุฎุทูุฉ 3: ุงุถุจุท Webhook ูู Meta
1. ุงูุชุญ Meta Developer Console
2. WhatsApp โ Configuration โ Webhook
3. ุงููุฃ ุงูุจูุงูุงุช:

**Callback URL:**
```
https://wahtsapp2.vercel.app/api/webhook
```

**Verify Token:**
```
whatsapp_crm_2024
```

4. ุงุถุบุท **Verify and Save**

#### ุงูุฎุทูุฉ 4: Subscribe to Events
ุจุนุฏ ูุง ุงูู Webhook ูุชุญููุ ุงุฎุชุงุฑ:
- โ messages
- โ message_status

---

## ุงููุดููุฉ 3: "Unauthorized Access" ูู Shopify

### ุงูุณุจุจ:
ุงูุชุทุจูู ูุด ูุซุจุช ุฃู ุงูุตูุงุญูุงุช ูุงูุตุฉ

### ุงูุญู:
1. Shopify Admin โ Settings โ Apps
2. ูู ุงูุชุทุจูู ูุด ููุฌูุฏ ูู ุงููุงุฆูุฉ:
   - ุงุฑุฌุน ูู Develop apps
   - ุงุถุบุท Install app
3. ูู ููุฌูุฏ ุจุณ ูุด ุดุบุงู:
   - ุงุญุฐูู
   - ุงุฑุฌุน install ุชุงูู

---

## ุงูุญู ุงูุจุฏูู: ุงุณุชุฎุฏู Manual Token (ุฃุณูู!)

### ููู Manual Token ุฃุญุณูุ
- โ ูุด ูุญุชุงุฌ OAuth
- โ ูุด ูุญุชุงุฌ Redirect URL
- โ ูุดุชุบู ููุฑุงู
- โ ูููุด ูุดุงูู

### ุงูุฎุทูุงุช:

#### 1. ุงุนูู Custom App ูู Shopify
```
Settings โ Apps โ Develop apps โ Create an app
```

#### 2. ุงุถุจุท ุงูุตูุงุญูุงุช
```
Configuration โ Admin API scopes
โ read_orders
โ write_orders
โ Save
```

#### 3. Install ุงูุชุทุจูู
```
Install app (ุฃุนูู ุงููููู)
```

#### 4. ุงุฌูุจ ุงูู Token
```
API credentials โ Admin API access token โ Reveal token once
```

#### 5. ุงูุณุฎ ุงูู Token
- Token ูุจุฏุฃ ุจู `shpat_`
- ุงุญูุธู ูู ููุงู ุขูู (ููุธูุฑ ูุฑุฉ ูุงุญุฏุฉ ุจุณ!)

#### 6. ุงุณุชุฎุฏูู ูู ุงููููุน
```
Settings โ Shopify Integration
โ Manual Token (Recommended)
โ Shop Subdomain: your-store
โ Admin API Access Token: shpat_xxxxx
โ Connect to Shopify
```

---

## ุงุฎุชุจุงุฑ ุดุงูู

### 1. ุงุฎุชุจุฑ Shopify Connection
```bash
node test-complete-system.js
```

### 2. ุงุฎุชุจุฑ WhatsApp Webhook
```bash
node test-whatsapp-api.js
```

### 3. ุงุฎุชุจุฑ Order Confirmation
```bash
node test-shopify-order-confirmation.js
```

---

## ุงูุฎูุงุตุฉ

### ููู Shopify:
- **OAuth**: ูุญุชุงุฌ ุชุถูู Redirect URL ูู Shopify
- **Manual Token**: ุฃุณูู ูุฃุณุฑุน ููุด ูุญุชุงุฌ OAuth

### ููู WhatsApp:
- ุชุฃูุฏ ูู Environment Variables ูู Vercel
- Redeploy ุจุนุฏ ุฃู ุชุบููุฑ
- ุงุณุชุฎุฏู Verify Token: `whatsapp_crm_2024`

---

## ูู ูุณู ููู ูุดุงูู

### Shopify:
1. ุชุฃูุฏ ุฅู ุงูุชุทุจูู ูุซุจุช (Installed)
2. ุชุฃูุฏ ูู ุงูุตูุงุญูุงุช (read_orders, write_orders)
3. ุฌุฑุจ Manual Token ุจุฏู OAuth

### WhatsApp:
1. ุชุฃูุฏ ุฅู ุงูู Webhook URL ุตุญูุญ
2. ุชุฃูุฏ ุฅู Verify Token ูุธุจูุท
3. ุดูู Logs ูู Vercel Dashboard

---

**ููุงุญุธุฉ ูููุฉ:** Manual Token ูู ุงูุญู ุงูุฃุณุฑุน ูุงูุฃุณูู. OAuth ูุญุชุงุฌ ุฎุทูุงุช ุฅุถุงููุฉ ููุด ุถุฑูุฑู ููุงุณุชุฎุฏุงู ุงูุนุงุฏู.
