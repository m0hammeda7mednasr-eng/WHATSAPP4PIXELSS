# ๐ ุฏููู ุฅุนุฏุงุฏ Message Templates

## ๐ฏ ุงููุฏู:
- **ุนููู ุฌุฏูุฏ** (ุฑูู ูุด ููุฌูุฏ) โ ุฅุฑุณุงู **Template** (ุชูููุฑ cost)
- **ุนููู ููุฌูุฏ** (ุฑูู ููุฌูุฏ) โ ุฅุฑุณุงู **ุฑุณุงูุฉ ุนุงุฏูุฉ** (ูุฌุงูู ูู ุงูู 24 ุณุงุนุฉ)

---

## ๐ก ููู ูุฏูุ

### ููุนููุงุก ุงูุฌุฏุฏ (Template):
- โ ููุชุญ conversation ุฌุฏูุฏ ุจู Template
- โ Template ุฃุฑุฎุต ูู ุงูุฑุณุงูุฉ ุงูุนุงุฏูุฉ
- โ ุดูู ุงุญุชุฑุงูู ุจู buttons

### ููุนููุงุก ุงูููุฌูุฏูู (ุฑุณุงูุฉ ุนุงุฏูุฉ):
- โ ูู ูู conversation ููุชูุญ (ุขุฎุฑ 24 ุณุงุนุฉ) โ ูุฌุงูู ุชูุงูุงู
- โ ูุด ููุญุณุจ ุนููู conversation ุฌุฏูุฏ
- โ ุชูููุฑ ูุจูุฑ ูู ุงูุชูููุฉ

---

## ๐ ุงูุฎุทูุงุช:

### 1๏ธโฃ ุชุดุบูู SQL ูุฅูุดุงุก ุฌุฏูู Templates

```bash
# ุงูุชุญ Supabase SQL Editor
# ุงูุณุฎ ูุงูุตู ูุญุชูู ุงูููู:
wahtsapp-main/setup-message-templates.sql
```

**ุฃู ุฑูุญ:**
```
https://supabase.com/dashboard/project/rmpgofswkpjxionzythf/sql/new
```

---

### 2๏ธโฃ ุณุฌู Templates ูู Meta Business Suite

#### Template 1: ููุนููุงุก ุงูุฌุฏุฏ (moon2)

**ุฑูุญ:**
```
https://business.facebook.com/wa/manage/message-templates/
```

**ุงููุง ุงูุจูุงูุงุช:**
- **Name:** `moon2`
- **Category:** Marketing
- **Language:** Arabic
- **Body:**
```
๐งพ ุฑูู ุงูุทูุจ: #{{1}}
๐งฃ ุงููุทุน: {{2}}
๐ฐ ุงููุฌููุน: {{3}} EGP
๐ ุงูุดุญู: {{4}} EGP
๐ต ุงูุฅุฌูุงูู: {{5}} EGP
๐ค ุงููุณุชูู: {{6}}
๐ ุงูุนููุงู: {{7}}

๐ฉ ูู ูุนุชูุฏ ุงูุทูุจุ
```

**Buttons:**
- Quick Reply: "ุชุฃููุฏ ุงูุทูุจ"
- Quick Reply: "ุฅูุบุงุก ุงูุทูุจ"

**Variables:**
1. order_number
2. products
3. subtotal
4. shipping
5. total
6. customer_name
7. address

---

**ููุญูุธุฉ:** ูุด ูุญุชุงุฌ template ููุนููุงุก ุงูููุฌูุฏููุ ููุจุนุชููู ุฑุณุงูุฉ ุนุงุฏูุฉ (ูุฌุงูู)

---

### 3๏ธโฃ ุงูุชุธุฑ ุงูููุงููุฉ ูู Meta

- ุจุนุฏ ุงูุชุณุฌููุ Meta ูุชุฑุงุฌุน ุงูู Templates
- ุนุงุฏุฉ ุจูุงุฎุฏ ูู ุณุงุนุงุช ูู 24 ุณุงุนุฉ
- ููุง ูุชูุงูู ุนููููุ ุงูู Status ููุจูู **"Approved"**

---

### 4๏ธโฃ ุณุฌู Template ูู ุงููููุน

**ุงูุชุญ ุงููููุน:**
```
http://localhost:5173
```

**ุงูุฎุทูุงุช:**
1. ุงุถุบุท ุนูู **Settings** (โ๏ธ)
2. ุงุฎุชุงุฑ ุชุงุจ **"Message Templates"**
3. ุงุถุบุท **"+ ุฅุถุงูุฉ Template"**

**Template ููุนููุงุก ุงูุฌุฏุฏ:**
- ุงุณู ุงูู Template: `moon2`
- ููุน ุงูู Template: `ุนููู ุฌุฏูุฏ (New Customer)`
- ูุต ุงูุฑุณุงูุฉ: (ููุณ ุงููู ูู Meta)
- ุญุงูุฉ ุงูู Template: `Approved` (ุจุนุฏ ุงูููุงููุฉ ูู Meta)

**ููุญูุธุฉ:** ูุด ูุญุชุงุฌ template ููุนููุงุก ุงูููุฌูุฏูู

---

### 5๏ธโฃ ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ

```bash
# ุฃููู ุงูุณูุฑูุฑ (Ctrl+C)
# ุดุบูู ุชุงูู
cd wahtsapp-main\server
node webhook-server-simple.js
```

---

## ๐งช ุงุฎุชุจุงุฑ:

### ุงูุทุฑููุฉ ุงูุณุฑูุนุฉ:
```bash
cd wahtsapp-main
TEST-TEMPLATES.bat
```

### Test 1: ุนููู ุฌุฏูุฏ
1. ุงุนูู order ูู Shopify ุจุฑูู ุฌุฏูุฏ (ูุด ููุฌูุฏ ูู ุงูู database)
2. ูุงุฒู ูุจุนุชูู **Template moon2**
3. ุดูู ุงูู logs:
   ```
   โ Contact created (NEW CUSTOMER)
   ๐ NEW CUSTOMER - Fetching template
   โ Using template: moon2
   ๐ค Sending WhatsApp message...
   ๐ Message type: template
   โ WhatsApp message sent
   ```

### Test 2: ุนููู ููุฌูุฏ
1. ุงุนูู order ุชุงูู ุจููุณ ุงูุฑูู
2. ูุงุฒู ูุจุนุชูู **ุฑุณุงูุฉ ุนุงุฏูุฉ** (ูุด template)
3. ุดูู ุงูู logs:
   ```
   โ Contact found (EXISTING CUSTOMER)
   ๐ฌ EXISTING CUSTOMER - Using regular text message (free within 24h)
   ๐ค Sending WhatsApp message...
   ๐ Message type: text
   โ WhatsApp message sent
   ```

---

## ๐ฐ ุงูููุงุฆุฏ:

### ููุนููุงุก ุงูุฌุฏุฏ (Template):
- โ ููุชุญ conversation ุฌุฏูุฏ ุจู Template
- โ Template ุฃุฑุฎุต ูู ุงูุฑุณุงูุฉ ุงูุนุงุฏูุฉ
- โ ุฑุณุงูุฉ ุงุญุชุฑุงููุฉ ุจู buttons
- โ ุชูููุฉ ุฃูู

### ููุนููุงุก ุงูููุฌูุฏูู (ุฑุณุงูุฉ ุนุงุฏูุฉ):
- โ ูู ูู conversation ููุชูุญ (ุขุฎุฑ 24 ุณุงุนุฉ) โ **ูุฌุงูู ุชูุงูุงู**
- โ ูุด ููุญุณุจ ุนููู conversation ุฌุฏูุฏ
- โ ุชูููุฑ ูุจูุฑ ูู ุงูุชูููุฉ
- โ ูุฑููุฉ ุฃูุซุฑ ูู ุงูุฑุณุงูุฉ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก:

### โ "Template not found"
**ุงูุณุจุจ:** ุงูู Template ูุด ูุณุฌู ูู ุงูู database  
**ุงูุญู:** ุณุฌูู ูู Settings โ Message Templates

### โ "Template not approved"
**ุงูุณุจุจ:** Meta ูุณู ูุฑุงุฌุน ุงูู Template  
**ุงูุญู:** ุงูุชุธุฑ ุงูููุงููุฉ ูู Meta

### โ "Invalid template parameters"
**ุงูุณุจุจ:** ุนุฏุฏ ุงููุชุบูุฑุงุช ูุด ูุทุงุจู  
**ุงูุญู:** ุชุฃูุฏ ุฅู ุงููุชุบูุฑุงุช ูู Meta ููุณูุง ูู ุงูููุฏ

### โ ูุจุนุช ุฑุณุงูุฉ ุนุงุฏูุฉ ุจุฏู Template
**ุงูุณุจุจ:** ุงูู Template ูุด active ุฃู ูุด approved  
**ุงูุญู:** 
1. ุชุฃูุฏ ุฅู ุงูู Template active ูู ุงููููุน
2. ุชุฃูุฏ ุฅู ุงูู Status = "approved"
3. ุชุฃูุฏ ุฅู ุงูุงุณู ุตุญูุญ

---

## ๐ ููู ูุดุชุบู ุงููุธุงู:

```
Order ุฌุฏูุฏ ูู Shopify
    โ
ููุชุด ุนู ุงูุนููู ูู ุงูู database
    โ
    โโโ ูุด ููุฌูุฏุ โ ุนููู ุฌุฏูุฏ
    โ       โ
    โ   ูุจุนุชูู Template "moon2"
    โ       โ
    โ   ููุชุญ conversation ุฌุฏูุฏ (ุจุชูููุฉ Template)
    โ
    โโโ ููุฌูุฏุ โ ุนููู ุญุงูู
            โ
        ูุจุนุชูู ุฑุณุงูุฉ ุนุงุฏูุฉ
            โ
        ูู ูู conversation ููุชูุญ โ ูุฌุงูู
        ูู ูููุด โ ููุชุญ conversation ุฌุฏูุฏ
```

---

## ๐ ููุงุญุธุงุช ูููุฉ:

1. **ุงุณู ุงูู Template ูุงุฒู ูููู ูุชุทุงุจู** ุจูู Meta ูุงููููุน
2. **ุนุฏุฏ ุงููุชุบูุฑุงุช ูุงุฒู ูููู ุตุญูุญ** (moon2 = 7 ูุชุบูุฑุงุช)
3. **ุงูู Template ูุงุฒู ูููู Approved** ูู Meta ุนุดุงู ูุดุชุบู
4. **ููุนููุงุก ุงูููุฌูุฏูู** โ ุฑุณุงูุฉ ุนุงุฏูุฉ (ูุฌุงูู ูู ูู conversation ููุชูุญ)
5. **Templates ุจุชููุฑ ุชูููุฉ** ููุนููุงุก ุงูุฌุฏุฏ ููุท

---

## ๐ Quick Start:

```bash
# 1. ุดุบู SQL
# ุงูุชุญ: https://supabase.com/dashboard/project/rmpgofswkpjxionzythf/sql/new
# ุงูุณุฎ: wahtsapp-main/setup-message-templates.sql

# 2. ุณุฌู Template ูู Meta
# https://business.facebook.com/wa/manage/message-templates/

# 3. ุณุฌู Template ูู ุงููููุน
# http://localhost:5173 โ Settings โ Message Templates

# 4. ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ
cd wahtsapp-main\server
node webhook-server-simple.js

# 5. ุงุฎุชุจุฑ!
# ุงุนูู order ุจุฑูู ุฌุฏูุฏ โ ูุงุฒู ูุจุนุช Template
# ุงุนูู order ุจุฑูู ููุฌูุฏ โ ูุงุฒู ูุจุนุช ุฑุณุงูุฉ ุนุงุฏูุฉ
```

---

**ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**
