# ๐ ุชุดุฎูุต ุณุฑูุน ูููุดููุฉ

## โ ุฃุณุฆูุฉ ูููุฉ

### 1. ุงูุจูุชููุงุช ุดุบุงูุฉุ
ููุง ุชุถุบุท "ุชุฃููุฏ ุงูุทูุจ โ":
- [ ] ุจุชูุตูู ุฑุณุงูุฉ ุชุฃููุฏุ
- [ ] ุงูู Tag ุจูุชุถุงู ูู Shopifyุ
- [ ] ูููุด ุฃู ุฑุฏ ุฎุงูุตุ

### 2. ุงูู Logs ูู Netlify
- [ ] ููู logs ุฃุตูุงูุ
- [ ] ููู error messagesุ
- [ ] ูููุด ุญุงุฌุฉ ุจุชุธูุฑุ

### 3. Shopify App Permissions
- [ ] ุงูู App ุนูุฏู `write_fulfillments`ุ
- [ ] ุงูู Access Token ุดุบุงูุ

---

## ๐ฏ ุงูุญููู ุญุณุจ ุงูุญุงูุฉ

### ุงูุญุงูุฉ 1: ูููุด ุฑุฏ ุฎุงูุต
**ุงููุดููุฉ:** ุงูุจูุชููุงุช ูุด ุดุบุงูุฉ ุฃุตูุงู

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุงูู Webhook URL ูู Meta
2. ุชุฃูุฏ ูู ุงูู Webhook Token
3. ุดูู Netlify Function Logs

---

### ุงูุญุงูุฉ 2: ุฑุณุงูุฉ ุชุฃููุฏ ุจุชูุตู ุจุณ ูููุด Fulfillment
**ุงููุดููุฉ:** ุงูุจูุชููุงุช ุดุบุงูุฉ ุจุณ ุงูู Fulfillment ูุงุดู

**ุงูุญู:**
1. ุดูู Netlify Logs
2. ุฏูุฑ ุนูู "โ Fulfillment error"
3. ุดูู ุงูู error message

**ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ:**

#### Error: "Location is not enabled"
```sql
-- ูู Supabase
UPDATE shopify_connections
SET location_id = NULL
WHERE brand_id = 'YOUR_BRAND_ID';
```

#### Error: "Access denied"
- ุงูู App ูุด ุนูุฏู ุตูุงุญูุงุช
- ุฑูุญ Shopify โ Settings โ Apps
- ุชุฃูุฏ ูู `write_fulfillments`

#### Error: "Order cannot be fulfilled"
- Order Status ูุงุฒู ูููู `paid`
- ูุด `pending` ุฃู `refunded`

---

### ุงูุญุงูุฉ 3: Tag ุจูุชุถุงู ุจุณ ูููุด Fulfillment
**ุงููุดููุฉ:** ุงูู Tag ุดุบุงู ุจุณ ุงูู Fulfillment ูุงุดู

**ุงูุญู ุงูุณุฑูุน:**
ุงุนูู Fulfillment ูุฏูู ูู Shopify ุนุดุงู ูุดูู ูู ููู ูุดููุฉ:

1. ุงุฏุฎู ุนูู Order ูู Shopify
2. ุงุถุบุท "Fulfill items"
3. ูู ุงุดุชุบู โ ุงููุดููุฉ ูู ุงูููุฏ
4. ูู ูุดุชุบูุด โ ุงููุดููุฉ ูู Order Status

---

## ๐ง ุงูุญู ุงููุคูุช

ูู ูุญุชุงุฌ ุงูููุถูุน ูุดุชุบู ููุฑุงู:

### ุงุนูู Fulfillment ูุฏูู
1. ููุง ูุฌููู Order
2. ุงุจุนุช ุฑุณุงูุฉ ุงูุชุฃููุฏ
3. ููุง ุงูุนููู ูุฃูุฏ
4. ุงูุชุญ Shopify
5. ุงุนูู Fulfill ูุฏูู

### ุฃู ุงุณุชุฎุฏู Shopify Flow
1. ุงุฏุฎู ุนูู Shopify โ Apps โ Flow
2. ุงุนูู Workflow:
   - Trigger: Order tagged with "whatsapp-confirmed"
   - Action: Fulfill order

---

## ๐ ูุนูููุงุช ูุญุชุงุฌูุง

ุนุดุงู ุฃูุฏุฑ ุฃุณุงุนุฏู ุฃูุชุฑุ ูุญุชุงุฌ:

### 1. Netlify Function Logs
```
# ุจุนุฏ ูุง ุชุถุบุท "ุชุฃููุฏ"
# ุงุฏุฎู ุนูู Netlify โ Functions โ whatsapp
# ุงูุณุฎ ูู ุงูู logs
```

### 2. Shopify Order Details
```
- Order Number: #____
- Order Status: ____
- Financial Status: ____
- Fulfillment Status: ____
- Tags: ____
```

### 3. Shopify App Permissions
```
# Shopify โ Settings โ Apps โ Your App
# ุงูุณุฎ ูุงุฆูุฉ ุงูุตูุงุญูุงุช
```

### 4. Database Query
```sql
-- ูู Supabase SQL Editor
SELECT 
  shop_url,
  access_token IS NOT NULL as has_token,
  location_id,
  is_active
FROM shopify_connections
WHERE brand_id = 'YOUR_BRAND_ID';
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุงูุฎุทูุฉ 1: ุชุฃูุฏ ูู ุงูุจูุชููุงุช
```bash
# ุงุถุบุท "ุชุฃููุฏ" ุนูู ุฑุณุงูุฉ
# ุดูู ูู ุจูุญุตู ุฃู ุญุงุฌุฉ
```

### ุงูุฎุทูุฉ 2: ุดูู Netlify Logs
```
# Netlify Dashboard โ Functions โ whatsapp
# ุดูู ุขุฎุฑ execution
```

### ุงูุฎุทูุฉ 3: ุดุงุฑู ุงููุนูููุงุช
```
# ุงูุณุฎ:
1. Netlify Logs (ูุงููุฉ)
2. Shopify Order details
3. App Permissions
4. Database query result
```

---

## ๐ก ูุตูุญุฉ ุณุฑูุนุฉ

ูู ุนุงูุฒ ุชุชุฃูุฏ ุฅู ุงูููุฏ ุดุบุงู:

```bash
# ุดุบู ุงูู diagnostic script
node diagnose-fulfillment.js
```

ุนุฏูู ููู:
- `SHOP_URL`
- `ACCESS_TOKEN`
- `ORDER_ID`

ููุทุจุนูู ุจุงูุธุจุท ุฅูู ุงููุดููุฉ!

---
ุชู ุงูุชุญุฏูุซ: ${new Date().toLocaleString('ar-EG')}
