# 🎯 كيف تستخدم Shopify Integration - دليل مصور

## ✅ الآن الـ Tabs شغالة!

### 1. فتح Settings

**اضغط على أيقونة Settings (⚙️) في أعلى اليسار**

```
┌─────────────────────────────────┐
│ WhatsApp CRM            [⚙️]    │ ← اضغط هنا
│ Brand: 4 Pixels         [▼]    │
└─────────────────────────────────┘
```

---

### 2. التنقل بين الـ Tabs

**هتلاقي 3 تابات في الأعلى:**

```
┌──────────────────────────────────────────────────┐
│  Settings                              [X]       │
├──────────────────────────────────────────────────┤
│                                                  │
│  [👤 Profile & WhatsApp]  [🏪 Shopify]  [📦 Orders]  │
│   ↑ Tab 1                  ↑ Tab 2      ↑ Tab 3  │
└──────────────────────────────────────────────────┘
```

#### Tab 1: Profile & WhatsApp
- معلومات الحساب
- معلومات البراند الحالي
- حالة WhatsApp Token

#### Tab 2: Shopify Integration
- ربط متجر Shopify
- اختبار الاتصال
- فصل الاتصال

#### Tab 3: Shopify Orders
- عرض كل الطلبات
- فلاتر (الكل / في الانتظار / مؤكدة / ملغاة)
- تفاصيل كل طلب

---

### 3. ربط Shopify (Tab 2)

#### الخطوة 1: اضغط على تاب "Shopify Integration"

```
┌──────────────────────────────────────────────────┐
│  [Profile]  [🏪 Shopify Integration]  [Orders]   │ ← اضغط هنا
├──────────────────────────────────────────────────┤
│                                                  │
│  🏪 ربط Shopify                                  │
│  اربط متجر Shopify لإرسال تأكيدات الطلبات       │
│                                                  │
│  ⚠️ قبل البدء:                                  │
│  1. افتح Shopify Admin Panel                    │
│  2. Settings → Apps → Develop apps              │
│  3. Create Custom App                           │
│  4. اطلب: read_orders, write_orders             │
│  5. انسخ Admin API access token                 │
│                                                  │
│  Shop URL                                        │
│  ┌────────────────────────────────────────────┐ │
│  │ your-store.myshopify.com                   │ │
│  └────────────────────────────────────────────┘ │
│  مثال: my-store.myshopify.com                   │
│                                                  │
│  Admin API Access Token                          │
│  ┌────────────────────────────────────────────┐ │
│  │ shpat_xxxxxxxxxxxxx                        │ │
│  └────────────────────────────────────────────┘ │
│  يبدأ بـ: shpat_                                │
│                                                  │
│  [🏪 ربط Shopify]                               │
│                                                  │
└──────────────────────────────────────────────────┘
```

#### الخطوة 2: املأ البيانات

**Shop URL:**
```
your-store.myshopify.com
```
⚠️ بدون https:// وبدون /admin

**Access Token:**
```
shpat_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```
⚠️ لازم يبدأ بـ shpat_

#### الخطوة 3: اضغط "ربط Shopify"

**لو نجح:**
```
┌──────────────────────────────────────────────────┐
│  ✅ متصل بنجاح                                   │
│  المتجر: your-store.myshopify.com               │
│  تم الاتصال: 12/2/2026                          │
│                                                  │
│  [🔄 اختبار الاتصال]  [🌐 فتح Shopify]  [❌ فصل] │
│                                                  │
│  💡 كيفية الاستخدام:                            │
│  1. اربط n8n بـ Shopify                         │
│  2. عند إنشاء طلب، أرسل POST إلى API            │
│  3. سيتم إرسال رسالة WhatsApp مع أزرار          │
│  4. عند الضغط، سيتم تحديث Shopify تلقائياً      │
└──────────────────────────────────────────────────┘
```

---

### 4. عرض الطلبات (Tab 3)

#### اضغط على تاب "Shopify Orders"

```
┌──────────────────────────────────────────────────┐
│  [Profile]  [Shopify]  [📦 Shopify Orders]       │ ← اضغط هنا
├──────────────────────────────────────────────────┤
│                                                  │
│  📦 طلبات Shopify                    [🔄 تحديث] │
│  تتبع حالة الطلبات المرسلة عبر WhatsApp          │
│                                                  │
│  [الكل (5)]  [في الانتظار]  [مؤكدة]  [ملغاة]   │
│                                                  │
│  ┌────────────────────────────────────────────┐ │
│  │ ⏰ طلب #1234                    [في الانتظار] │
│  │ العميل: أحمد محمد                           │
│  │ الهاتف: 201066184859                        │
│  │ الإجمالي: 500 EGP                           │
│  │ التاريخ: 12/2/2026, 6:30 PM                │
│  │                                    [🔗]     │
│  └────────────────────────────────────────────┘ │
│                                                  │
│  ┌────────────────────────────────────────────┐ │
│  │ ✅ طلب #1233                         [مؤكدة] │
│  │ العميل: محمد علي                            │
│  │ الهاتف: 201012345678                        │
│  │ الإجمالي: 750 EGP                           │
│  │ التاريخ: 12/2/2026, 5:15 PM                │
│  │ ✅ تم التأكيد: 12/2/2026, 5:20 PM          │
│  │                                    [🔗]     │
│  └────────────────────────────────────────────┘ │
│                                                  │
└──────────────────────────────────────────────────┘
```

#### الفلاتر:

**الكل:** كل الطلبات
```
[الكل (5)]  [في الانتظار]  [مؤكدة]  [ملغاة]
 ↑ اضغط هنا
```

**في الانتظار:** الطلبات اللي لسه مستنية رد
```
[الكل]  [في الانتظار]  [مؤكدة]  [ملغاة]
         ↑ اضغط هنا
```

**مؤكدة:** الطلبات اللي العميل أكدها
```
[الكل]  [في الانتظار]  [مؤكدة]  [ملغاة]
                        ↑ اضغط هنا
```

**ملغاة:** الطلبات اللي العميل ألغاها
```
[الكل]  [في الانتظار]  [مؤكدة]  [ملغاة]
                                ↑ اضغط هنا
```

---

### 5. تفاصيل الطلب

**كل طلب يعرض:**

```
┌────────────────────────────────────────────────┐
│ ⏰ طلب #1234                      [في الانتظار] │ ← الحالة
│                                                │
│ العميل: أحمد محمد                              │ ← اسم العميل
│ الهاتف: 201066184859                           │ ← رقم الهاتف
│ الإجمالي: 500 EGP                              │ ← السعر
│ التاريخ: 12/2/2026, 6:30 PM                   │ ← وقت الإرسال
│                                                │
│ [لو تم التأكيد:]                               │
│ ✅ تم التأكيد: 12/2/2026, 6:35 PM             │
│                                                │
│ [لو تم الإلغاء:]                               │
│ ❌ تم الإلغاء: 12/2/2026, 6:35 PM             │
│                                                │
│                                       [🔗]     │ ← فتح في Shopify
└────────────────────────────────────────────────┘
```

---

### 6. الحالات (Status)

#### ⏰ في الانتظار (Pending)
```
[في الانتظار] ← أصفر
```
- الطلب اتبعت للعميل
- لسه مستني رد
- العميل لسه ما ضغطش على أي زرار

#### ✅ مؤكدة (Confirmed)
```
[مؤكدة] ← أخضر
```
- العميل ضغط "تأكيد ✅"
- Shopify اتحدث تلقائياً
- تم إضافة Tag: "whatsapp-confirmed"

#### ❌ ملغاة (Cancelled)
```
[ملغاة] ← أحمر
```
- العميل ضغط "إلغاء ❌"
- Shopify اتحدث تلقائياً
- الطلب اتألغى في Shopify

---

### 7. Real-time Updates

**الطلبات بتتحدث تلقائياً!**

```
1. عميل يضغط زرار في WhatsApp
         ↓
2. Backend يستقبل webhook
         ↓
3. Backend يحدث Shopify
         ↓
4. Backend يحدث قاعدة البيانات
         ↓
5. الواجهة تتحدث تلقائياً (بدون refresh!)
         ↓
6. الحالة تتغير من "في الانتظار" → "مؤكدة"
```

**مش محتاج تعمل refresh! 🎉**

---

### 8. اختبار الاتصال

**في تاب Shopify Integration:**

```
┌──────────────────────────────────────────────────┐
│  ✅ متصل بنجاح                                   │
│  المتجر: your-store.myshopify.com               │
│                                                  │
│  [🔄 اختبار الاتصال]  [🌐 فتح Shopify]  [❌ فصل] │
│   ↑ اضغط هنا للاختبار                           │
└──────────────────────────────────────────────────┘
```

**لو الاختبار نجح:**
```
✅ الاتصال يعمل! المتجر: Your Store Name
```

**لو فشل:**
```
❌ فشل الاختبار: Invalid credentials
```

---

### 9. فتح الطلب في Shopify

**اضغط على أيقونة 🔗 جنب أي طلب:**

```
┌────────────────────────────────────────────────┐
│ ✅ طلب #1234                           [مؤكدة] │
│ ...                                            │
│                                       [🔗]     │ ← اضغط هنا
└────────────────────────────────────────────────┘
```

**هيفتح Shopify في تاب جديد:**
```
https://admin.shopify.com/store/orders/ORDER_ID
```

---

### 10. فصل الاتصال

**في تاب Shopify Integration:**

```
┌──────────────────────────────────────────────────┐
│  ✅ متصل بنجاح                                   │
│                                                  │
│  [🔄 اختبار]  [🌐 فتح Shopify]  [❌ فصل الاتصال] │
│                                   ↑ اضغط هنا    │
└──────────────────────────────────────────────────┘
```

**هيطلب تأكيد:**
```
هل أنت متأكد من فصل Shopify؟
[Cancel]  [OK]
```

---

## 🎯 الـ Flow الكامل

### 1. ربط Shopify
```
Settings → Shopify Integration → حط البيانات → ربط
```

### 2. إرسال طلب (من n8n أو test script)
```
POST /api/shopify/send-order-confirmation
```

### 3. العميل يستلم رسالة WhatsApp
```
مرحباً أحمد 👋
تم استلام طلبك بنجاح! 🎉
📦 رقم الطلب: #1234
💰 الإجمالي: 500 جنيه

[تأكيد الطلب ✅]  [إلغاء الطلب ❌]
```

### 4. العميل يضغط زرار
```
WhatsApp → Webhook → Backend → Shopify
```

### 5. شوف النتيجة
```
Settings → Shopify Orders → شوف الحالة اتغيرت
```

---

## ✅ Checklist

- [ ] فتحت Settings
- [ ] شفت الـ 3 tabs
- [ ] دخلت على Shopify Integration
- [ ] ربطت Shopify
- [ ] اختبرت الاتصال
- [ ] دخلت على Shopify Orders
- [ ] جربت الفلاتر
- [ ] شفت تفاصيل طلب
- [ ] فتحت طلب في Shopify

---

## 🎉 كل حاجة شغالة!

**الآن عندك:**
- ✅ 3 tabs واضحة ومنظمة
- ✅ ربط Shopify سهل
- ✅ عرض الطلبات مع الفلاتر
- ✅ Real-time updates
- ✅ تفاصيل كاملة لكل طلب

**جرب دلوقتي! 🚀**
