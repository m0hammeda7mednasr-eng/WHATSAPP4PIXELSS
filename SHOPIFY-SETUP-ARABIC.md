# ๐๏ธ ุฏููู ุฑุจุท Shopify - ูุงูู ูููุตู

## ๐ ุฌุฏูู ุงููุญุชููุงุช
1. [ุงููุดููุฉ ุงูุญุงููุฉ](#ุงููุดููุฉ-ุงูุญุงููุฉ)
2. [ุงูุญู ุงูุณุฑูุน](#ุงูุญู-ุงูุณุฑูุน)
3. [ุงูุฎุทูุงุช ุงูุชูุตูููุฉ](#ุงูุฎุทูุงุช-ุงูุชูุตูููุฉ)
4. [ุฅุนุฏุงุฏ Shopify App](#ุฅุนุฏุงุฏ-shopify-app)
5. [ุงูุฑุจุท ูุงูุงุฎุชุจุงุฑ](#ุงูุฑุจุท-ูุงูุงุฎุชุจุงุฑ)
6. [ุญู ุงููุดุงูู](#ุญู-ุงููุดุงูู)

---

## ๐ด ุงููุดููุฉ ุงูุญุงููุฉ

ุนูุฏ ูุชุญ Settings โ Shopify Integration ุชุธูุฑ:
- โ Badge ุฑูุงุฏู "Not Connected"
- โ ุจุนุฏ ููุก ุงูุจูุงูุงุช ูุงูุถุบุท ุนูู Connect ูุง ูุญุฏุซ ุดูุก
- โ ุจุนุฏ Refresh ุชุฎุชูู ุงูุจูุงูุงุช

**ุงูุณุจุจ:** ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ููุฌูุฏุฉ ูู Supabase!

---

## โก ุงูุญู ุงูุณุฑูุน (ุฏูููุชูู ููุท)

### 1. ุงูุชุญ Supabase SQL Editor
```
https://supabase.com/dashboard/project/rmpgofswkpjxionzythf/sql/new
```

### 2. ุงูุณุฎ ูุงูุตู
ุงูุชุญ ููู: `COMPLETE-SHOPIFY-SETUP.sql`
ุงูุณุฎ ูู ูุญุชููุงุชู ูุงูุตูู ูู SQL Editor

### 3. ุดุบูู
ุงุถุบุท ุฒุฑ "Run" ุงูุฃุฎุถุฑ ุฃู `Ctrl + Enter`

### 4. ุชุญูู
```bash
node test-shopify-setup.js
```

ูุฌุจ ุฃู ุชุฑู: `๐ SUCCESS! All tests passed!`

---

## ๐ ุงูุฎุทูุงุช ุงูุชูุตูููุฉ

### ุงููุฑุญูุฉ 1: ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุงูุฎุทูุฉ 1: ุงูุชุญ Supabase
1. ุงุฐูุจ ุฅูู: https://supabase.com
2. ุณุฌู ุฏุฎูู
3. ุงุฎุชุฑ ูุดุฑูุนู: `rmpgofswkpjxionzythf`

#### ุงูุฎุทูุฉ 2: ุงูุชุญ SQL Editor
1. ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุงุฎุชุฑ "SQL Editor"
2. ุงุถุบุท "New query"

#### ุงูุฎุทูุฉ 3: ุดุบูู SQL
1. ุงูุชุญ ููู: `COMPLETE-SHOPIFY-SETUP.sql`
2. ุงูุณุฎ **ูู** ูุญุชููุงุชู
3. ุงูุตูู ูู SQL Editor
4. ุงุถุบุท "Run" ุฃู `Ctrl + Enter`
5. ุงูุชุธุฑ 2-3 ุซูุงูู
6. ูุฌุจ ุฃู ุชุฑู: "Success. No rows returned"

#### ุงูุฎุทูุฉ 4: ุชุญูู ูู ุงููุฌุงุญ
ุงูุชุญ Terminal:
```bash
node test-shopify-setup.js
```

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
๐ SUCCESS! All tests passed!
โ Database is ready for Shopify integration
```

---

### ุงููุฑุญูุฉ 2: ุฅุนุฏุงุฏ Shopify App

#### ุงูุฎุทูุฉ 1: ุงูุชุญ Shopify Admin
ุงุฐูุจ ุฅูู ูุชุฌุฑู ูู Shopify

#### ุงูุฎุทูุฉ 2: ุงุฐูุจ ุฅูู Apps
```
Settings โ Apps and sales channels โ Develop apps
```

#### ุงูุฎุทูุฉ 3: ุฃูุดุฆ App ุฌุฏูุฏ
1. ุงุถุบุท "Create an app"
2. ุงูุชุจ ุงุณู: `WhatsApp CRM`
3. ุงุถุบุท "Create app"

#### ุงูุฎุทูุฉ 4: ุถุจุท Configuration
1. ุงุฐูุจ ุฅูู ุชุจููุจ "Configuration"
2. ุชุญุช "App URL" ุงูุตู:
   ```
   https://wahtsapp2.vercel.app/api/shopify/oauth/callback
   ```
3. ุงุถุบุท "Save"

#### ุงูุฎุทูุฉ 5: ุถุจุท Permissions
1. ุงุถุบุท "Configure Admin API scopes"
2. ุงุจุญุซ ุนู ููุนูู:
   - โ `read_orders` - ููุฑุงุกุฉ ุงูุทูุจุงุช
   - โ `write_orders` - ูุชุญุฏูุซ ุงูุทูุจุงุช
3. ุงุถุบุท "Save"

#### ุงูุฎุทูุฉ 6: ุงุญุตู ุนูู Credentials
1. ุงุฐูุจ ุฅูู ุชุจููุจ "API credentials"
2. ุงูุณุฎ:
   - **Client ID** (ูุณูู ุฃูุถุงู API Key)
   - **Client Secret** (ูุณูู ุฃูุถุงู API Secret Key)
3. ุงุญุชูุธ ุจูู ูู ููุงู ุขูู

---

### ุงููุฑุญูุฉ 3: ุงูุฑุจุท ูุงูุงุฎุชุจุงุฑ

#### ุงูุฎุทูุฉ 1: ุงูุชุญ ุงููููุน
```
https://wahtsapp2.vercel.app
```

#### ุงูุฎุทูุฉ 2: ุงุฐูุจ ุฅูู Settings
1. ุงุถุบุท ุนูู ุฃููููุฉ Settings (โ๏ธ)
2. ุงุฎุชุฑ ุชุจููุจ "Shopify Integration"

#### ุงูุฎุทูุฉ 3: ุงููุฃ ุงูุจูุงูุงุช
1. **Shop Subdomain**: ุงุณู ูุชุฌุฑู ููุท
   - ูุซุงู: ุฅุฐุง ูุงู ูุชุฌุฑู `my-store.myshopify.com`
   - ุงูุชุจ ููุท: `my-store`

2. **Client ID**: ุงูุตูู ูู Shopify

3. **Client Secret**: ุงูุตูู ูู Shopify

4. ุชุฃูุฏ ูู ุชูุนูู: โ "Use OAuth (Recommended)"

#### ุงูุฎุทูุฉ 4: ุงุถุบุท Connect
1. ุงุถุบุท ุฒุฑ "Connect with OAuth"
2. ุณูุชู ุชุญูููู ุฅูู Shopify
3. ุงุถุบุท "Install app"
4. ุณูุชู ุชุญูููู ูุฑุฉ ุฃุฎุฑู ูููููุน

#### ุงูุฎุทูุฉ 5: ุชุญูู ูู ุงููุฌุงุญ
ูุฌุจ ุฃู ุชุฑู:
- โ Badge ุฃุฎุถุฑ "Connected"
- ุงุณู ูุชุฌุฑู
- ุชุงุฑูุฎ ุงูุฑุจุท
- ุฒุฑ "Test Connection"

#### ุงูุฎุทูุฉ 6: ุงุฎุชุจุฑ ุงูุงุชุตุงู
1. ุงุถุบุท "Test Connection"
2. ูุฌุจ ุฃู ุชุฑู: `โ Connection works! Store: [ุงุณู ูุชุฌุฑู]`

---

## ๐ฏ ููู ุชุณุชุฎุฏู ุงูููุฒุฉ

### 1. ุฅุฑุณุงู ุชุฃููุฏ ุทูุจ
ุนูุฏูุง ูุฃุชู ุทูุจ ุฌุฏูุฏ ูู Shopifyุ ููููู ุฅุฑุณุงู ุฑุณุงูุฉ WhatsApp:

```javascript
// ูู n8n ุฃู ุฃู webhook
POST https://wahtsapp2.vercel.app/api/shopify/send-order-confirmation

Body:
{
  "brandId": "your-brand-id",
  "orderId": "5678901234",
  "orderNumber": "#1234",
  "customerPhone": "201234567890",
  "customerName": "ุฃุญูุฏ ูุญูุฏ",
  "totalPrice": "500.00",
  "currency": "EGP",
  "items": [
    {
      "name": "ููุชุฌ 1",
      "quantity": 2,
      "price": "250.00"
    }
  ]
}
```

### 2. ุงูุฑุณุงูุฉ ุงูุชู ุณูุณุชูุจููุง ุงูุนููู
```
๐๏ธ ุทูุจ ุฌุฏูุฏ #1234

ูุฑุญุจุงู ุฃุญูุฏ ูุญูุฏ!

ุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ:
โข ููุชุฌ 1 ร 2 - 250.00 EGP

๐ฐ ุงูุฅุฌูุงูู: 500.00 EGP

[ุฒุฑ: โ ุชุฃููุฏ ุงูุทูุจ]
[ุฒุฑ: โ ุฅูุบุงุก ุงูุทูุจ]
```

### 3. ุนูุฏ ุถุบุท ุงูุนููู ุนูู ุฒุฑ
- โ ุฅุฐุง ุถุบุท "ุชุฃููุฏ": ูุชู ุชุญุฏูุซ Shopify ุชููุงุฆูุงู
- โ ุฅุฐุง ุถุบุท "ุฅูุบุงุก": ูุชู ุฅูุบุงุก ุงูุทูุจ ูู Shopify

### 4. ูุชุงุจุนุฉ ุงูุทูุจุงุช
ุงุฐูุจ ุฅูู: Settings โ Shopify Orders
- ุดุงูุฏ ูู ุงูุทูุจุงุช
- ููุชุฑ ุญุณุจ ุงูุญุงูุฉ (Pending/Confirmed/Cancelled)
- ุดุงูุฏ ุชูุงุตูู ูู ุทูุจ

---

## ๐ง ุญู ุงููุดุงูู

### ุงููุดููุฉ 1: "Not Connected" ุจุนุฏ ุชุดุบูู SQL
**ุงูุญู:**
```bash
# ุชุญูู ูู ุงูุฌุฏุงูู
node check-tables.js

# ูุฌุจ ุฃู ุชุฑู โ ุจุฌุงูุจ ูู ุฌุฏูู
# ุฅุฐุง ุฑุฃูุช โุ ุดุบูู SQL ูุฑุฉ ุฃุฎุฑู
```

### ุงููุดููุฉ 2: "Buffer is not defined"
**ุงูุญู:** โ ุชู ุญููุง! ูุณุชุฎุฏู `btoa()` ุงูุขู

### ุงููุดููุฉ 3: "Invalid credentials"
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
1. Client ID ุฎุทุฃ
2. Client Secret ุฎุทุฃ
3. Shop Subdomain ุฎุทุฃ (ุชุฃูุฏ ูู ุนุฏู ูุชุงุจุฉ .myshopify.com)

**ุงูุญู:**
- ุงูุณุฎ Credentials ูุฑุฉ ุฃุฎุฑู ูู Shopify
- ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูุณุงูุงุช ุฒุงุฆุฏุฉ

### ุงููุดููุฉ 4: OAuth Redirect ูุดู
**ุงูุณุจุจ:** Redirect URL ุบูุฑ ุตุญูุญ ูู Shopify

**ุงูุญู:**
1. ุงุฐูุจ ุฅูู Shopify App โ Configuration
2. ุชุฃูุฏ ูู ุฃู App URL ูู ุจุงูุถุจุท:
   ```
   https://wahtsapp2.vercel.app/api/shopify/oauth/callback
   ```
3. ุงุญูุธ ุงูุชุบููุฑุงุช
4. ุฌุฑุจ ูุฑุฉ ุฃุฎุฑู

### ุงููุดููุฉ 5: "Could not find table"
**ุงูุณุจุจ:** ูู ูุชู ุชุดุบูู SQL ูู Supabase

**ุงูุญู:**
1. ุงูุชุญ Supabase SQL Editor
2. ุดุบูู: `COMPLETE-SHOPIFY-SETUP.sql`
3. ุชุญูู: `node test-shopify-setup.js`

### ุงููุดููุฉ 6: ุงูุจูุงูุงุช ุชุฎุชูู ุจุนุฏ Refresh
**ุงูุณุจุจ:** ุงูุฌุฏุงูู ุบูุฑ ููุฌูุฏุฉ ุฃู RLS ุบูุฑ ูุถุจูุท

**ุงูุญู:**
```bash
# ุดุบูู ุงูุงุฎุชุจุงุฑ
node test-shopify-setup.js

# ุฅุฐุง ูุดูุ ุดุบูู SQL ูุฑุฉ ุฃุฎุฑู
```

---

## ๐ ูููุงุช ูููุฉ

| ุงูููู | ุงููุตู |
|------|-------|
| `COMPLETE-SHOPIFY-SETUP.sql` | SQL ูุงูู ูุฅูุดุงุก ุงูุฌุฏุงูู |
| `test-shopify-setup.js` | ุงุฎุชุจุงุฑ ุณุฑูุน ููุชุญูู ูู ุงูุฅุนุฏุงุฏ |
| `check-tables.js` | ูุญุต ูุฌูุฏ ุงูุฌุฏุงูู |
| `check-shopify-connection.js` | ูุญุต ุญุงูุฉ ุงูุงุชุตุงู |
| `test-shopify-order-confirmation.js` | ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุฑุณุงูุฉ |

---

## โ Checklist

ูุจู ุฃู ุชุจุฏุฃุ ุชุฃูุฏ ูู:
- [ ] ุชุดุบูู SQL ูู Supabase
- [ ] `node test-shopify-setup.js` ูุนุทู โ
- [ ] ุฅูุดุงุก Shopify App
- [ ] ูุณุฎ Client ID ู Client Secret
- [ ] ุถุจุท Redirect URL ูู Shopify
- [ ] ุชูุนูู Permissions (read_orders, write_orders)

ุนูุฏ ุงูุฑุจุท:
- [ ] Shop Subdomain ุตุญูุญ (ุจุฏูู .myshopify.com)
- [ ] Client ID ุตุญูุญ
- [ ] Client Secret ุตุญูุญ
- [ ] OAuth ููุนูู

ุจุนุฏ ุงูุฑุจุท:
- [ ] Badge ุฃุฎุถุฑ "Connected" ุธุงูุฑ
- [ ] Test Connection ูุนูู
- [ ] ูู Profile tab: โ Shopify Connected

---

## ๐ ุงููุฌุงุญ!

ุฅุฐุง ุฑุฃูุช ูู ูุฐุง:
- โ Badge ุฃุฎุถุฑ "Connected"
- โ Test Connection ูุนูู
- โ ุงุณู ุงููุชุฌุฑ ุธุงูุฑ
- โ ูู Profile: Shopify Connected

**ูุจุฑูู! ๐ ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู!**

ุงูุขู ููููู:
1. ุฅุฑุณุงู ุชุฃููุฏุงุช ุงูุทูุจุงุช ุนุจุฑ WhatsApp
2. ุงูุนููุงุก ูุถุบุทูู ุนูู ุงูุฃุฒุฑุงุฑ
3. Shopify ูุชุญุฏุซ ุชููุงุฆูุงู
4. ูุชุงุจุนุฉ ูู ุดูุก ูู Dashboard

---

## ๐ ููุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุดุบูู: `node test-shopify-setup.js`
2. ุฎุฐ screenshot ูู ุงููุชูุฌุฉ
3. ุฎุฐ screenshot ูู ุงูุฎุทุฃ ูู ุงููุชุตูุญ (F12 โ Console)
4. ุฃุฑุณููู ูุน ูุตู ุงููุดููุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ:** ุงูุขู
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู
